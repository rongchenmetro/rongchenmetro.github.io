<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>容晨轨道交通官网</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#1a56db',
                        secondary: '#3b82f6',
                        accent: '#60a5fa',
                        dark: '#0f172a',
                        skyblue: '#87CEEB',
                        vermilion: '#E63946',
                        leafgreen: '#4D7C0F',
                    },
                    fontFamily: {
                        sans: ['Inter', 'system-ui', 'sans-serif'],
                        kai: ['KaiTi', 'STKaiti', 'sans-serif'],
                        song: ['SimSun', 'STSong', 'sans-serif'],
                        fs: ['FangSong', 'STFangsong', 'sans-serif'],
                        franklin: ['"Franklin Gothic Book"', 'sans-serif'],
                    },
                    backgroundImage: {
                        'custom-bg': "url('http://daixiawunian.ct.ws/wp-content/uploads/2025/07/VCG211489098074-1.jpg')",
                    }
                }
            }
        }
    </script>
    <style type="text/tailwindcss">
        @layer utilities {
            .slide-transition {
                transition: transform 0.5s ease-in-out;
            }
            .text-shadow {
                text-shadow: 0 2px 4px rgba(0,0,0,0.1);
            }
            .bg-blur {
                backdrop-filter: blur(8px);
            }
            .scroll-indicator {
                animation: bounce 2s infinite;
            }
            @keyframes bounce {
                0%, 20%, 50%, 80%, 100% {transform: translateY(0);}
                40% {transform: translateY(-20px);}
                60% {transform: translateY(-10px);}
            }
            .bottom10 {
                bottom: 10px !important;
            }
            .modal-backdrop {
                backdrop-filter: blur(5px);
            }
        }
    </style>
</head>
<body class="min-h-screen overflow-x-hidden bg-custom-bg bg-fixed bg-cover bg-center">
    <!-- 登录按钮 -->
    <div class="fixed top-6 right-6 z-50">
        <button id="authButton" class="bg-white bg-opacity-90 hover:bg-opacity-100 text-dark font-medium py-2 px-4 rounded-lg shadow-md transition-all duration-300 flex items-center">
            <i class="fa fa-github mr-2"></i>
            <span id="authText">登录</span>
        </button>
    </div>

    <!-- 导航指示器 -->
    <div class="fixed right-6 top-1/2 transform -translate-y-1/2 z-50 hidden md:flex flex-col items-center space-y-4">
        <button class="w-3 h-3 rounded-full bg-primary transition-all duration-300 scale-150" data-section="section1"></button>
        <button class="w-3 h-3 rounded-full bg-gray-300 transition-all duration-300" data-section="section2"></button>
    </div>

    <!-- 页面内容 -->
    <div id="page-container" class="w-full">
        <section id="section1" class="min-h-screen flex flex-col items-center justify-center relative bg-gray-50 bg-opacity-80">
            <!-- 容晨轨道交通标志和名称 -->
            <div class="flex items-center mb-12">
                <div class="w-24 h-24 rounded-full overflow-hidden border-4 border-primary shadow-lg">
                    <img src="http://daixiawunian.ct.ws/wp-content/uploads/2025/07/IMG_3295-1.jpeg" 
                         alt="容晨轨道交通logo" 
                         class="w-full h-full object-cover">
                </div>
                <div>
                    <h1 class="text-5xl font-bold text-dark font-song">容晨轨道交通</h1>
                    <p class="text-xl text-gray-600 font-franklin">Rongchen Metro</p>
                </div>
            </div>
            
            <!-- 欢迎信息 -->
            <div class="mt-10 text-center max-w-2xl px-6">
                <h2 class="text-4xl font-bold text-vermilion mb-4 font-song">欢迎访问容晨轨道交通官网！</h2>
                <div class="w-64 h-1 bg-accent mx-auto mt-6 mb-10"></div>
            </div>
            
            <!-- 向下滚动提示 -->
            <div class="absolute bottom-10 text-center scroll-indicator">
                <a href="#section2" class="text-gray-500 flex flex-col items-center">
                    <span class="mb-2">向下滚动查看更多</span>
                    <i class="fa fa-angle-down text-2xl"></i>
                </a>
            </div>
        </section>

        <!-- 第二页 -->
        <section id="section2" class="min-h-screen flex flex-col items-center justify-center py-20 relative bg-gray-100 bg-opacity-80">
            <!-- 信息内容 -->
            <div class="max-w-2xl mx-auto px-6 bg-white bg-opacity-90 bg-blur p-8 rounded-lg shadow-lg mb-12">
                <div class="space-y-8 text-lg font-fs text-leafgreen leading-relaxed">
                    <!-- 第一段 -->
                    <p class="pl-2 border-l-4 border-primary/30">
                        容晨轨道交通为容晨市（虚拟）的第一个公共交通出行方式，属于容晨交通旗下部门。作为城市交通网络的核心组成部分，我们致力于为市民提供高效、安全、舒适的出行服务。
                    </p>
                    
                    <!-- 交通体系部分 -->
                    <div class="space-y-4">
                        <p class="font-semibold text-primary">容晨轨道交通管理着容晨市（虚拟）的多元化轨道交通体系，涵盖：</p>
                        <ul class="space-y-3 pl-6">
                            <li class="flex items-start">
                                <i class="fa fa-train text-primary mt-1 mr-3"></i>
                                <span>高铁与城际列车（连接城市内外的快速通道）</span>
                            </li>
                            <li class="flex items-start">
                                <i class="fa fa-tram text-primary mt-1 mr-3"></i>
                                <span>空轨、有轨电车（城市低空与地面交通网络）</span>
                            </li>
                            <li class="flex items-start">
                                <i class="fa fa-subway text-primary mt-1 mr-3"></i>
                                <span>地铁、轻轨（核心城区骨干交通）</span>
                            </li>
                            <li class="flex items-start">
                                <i class="fa fa-monorail text-primary mt-1 mr-3"></i>
                                <span>市域快轨、磁悬浮列车、单轨式列车等特色交通方式</span>
                            </li>
                        </ul>
                    </div>
                    
                    <!-- 地铁线路部分 -->
                    <p class="pl-2 border-l-4 border-primary/30">
                        目前，容晨轨道交通的地铁网络（含轻轨）已形成8条线路的完善布局，分别是1号线至8号线，各线路覆盖城市主要功能区、商业中心及居民区，实现了便捷的换乘体系。
                    </p>
                    
                    <!-- 更多资讯部分 -->
                    <p class="pl-2 border-l-4 border-primary/30">
                        关于容晨轨道交通的更多资讯，包括线路规划、运营时间、票价信息等，可在呆下午年的博客中查看详细内容。
                    </p>
                    
                    <!-- 虚拟城市部分 -->
                    <p class="pl-2 border-l-4 border-primary/30">
                        容晨市（虚拟）为呆下午年在Minecraft中创建并改造的虚拟城市，通过Minecraft Transit Railway等多种Mod实现了逼真的轨道交通系统模拟，还原了现实中地铁网络的运营场景。
                    </p>
                </div>
            </div>
            
            <!-- 按钮组单独分区 -->
            <div class="max-w-2xl w-full mx-auto px-6 bg-white bg-opacity-90 bg-blur p-6 rounded-lg shadow-lg">
                <h3 class="text-xl font-bold text-primary mb-6 text-center font-song">相关链接</h3>
                <div class="flex flex-wrap justify-center gap-4">
                    <button class="border-2 border-skyblue text-skyblue hover:border-primary hover:text-primary bg-transparent px-4 py-2 rounded-md transition-colors duration-300 text-sm" 
                            onclick="window.open('https://minecrafttransitrailway.com/', '_blank')">
                        Minecraft Transit Railway Mod 官网
                    </button>
                    <button class="border-2 border-skyblue text-skyblue hover:border-primary hover:text-primary bg-transparent px-4 py-2 rounded-md transition-colors duration-300 text-sm" 
                            onclick="window.open('https://www.minecraft.net/zh-hans', '_blank')">
                        Minecraft 官网
                    </button>
                    <button class="border-2 border-skyblue text-skyblue hover:border-primary hover:text-primary bg-transparent px-4 py-2 rounded-md transition-colors duration-300 text-sm" 
                            onclick="window.open('https://daixiawunian.mysxl.cn', '_blank')">
                        呆下午年的个人网站
                    </button>
                    <button class="border-2 border-skyblue text-skyblue hover:border-primary hover:text-primary bg-transparent px-4 py-2 rounded-md transition-colors duration-300 text-sm" 
                            onclick="window.open('https://daixiawunian.ct.ws', '_blank')">
                        呆下午年的博客
                    </button>
                </div>
            </div>
            
            <!-- 新增乘客信息 -->
            <div class="mt-12 text-center max-w-2xl px-6">
                <p class="text-xl font-bold text-vermilion font-kai">乘客可免费乘坐容晨轨道交通中的地铁、轻轨</p>
            </div>
            
            <!-- 向上滚动提示 -->
            <div class="absolute bottom10 text-center scroll-indicator">
                <a href="#section1" class="text-gray-500 flex flex-col items-center">
                    <span class="mb-2">向上滚动返回顶部</span>
                    <i class="fa fa-angle-up text-2xl"></i>
                </a>
            </div>
        </section>
    </div>

    <!-- 用户信息模态框 -->
    <div id="userModal" class="fixed inset-0 bg-black bg-opacity-50 modal-backdrop flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-lg shadow-xl max-w-md w-full mx-4 overflow-hidden transform transition-all">
            <div class="p-6">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-xl font-bold text-primary">用户信息</h3>
                    <button id="closeModal" class="text-gray-500 hover:text-gray-700">
                        <i class="fa fa-times text-xl"></i>
                    </button>
                </div>
                <div id="userInfo" class="flex flex-col items-center">
                    <div class="w-24 h-24 rounded-full overflow-hidden mb-4 border-2 border-primary">
                        <img id="userAvatar" src="https://via.placeholder.com/100" alt="用户头像" class="w-full h-full object-cover">
                    </div>
                    <h4 id="userName" class="text-xl font-bold mb-2">未登录</h4>
                    <p id="userLogin" class="text-gray-600 mb-4">请登录以获取更多服务</p>
                    <button id="logoutButton" class="mt-4 bg-gray-200 hover:bg-gray-300 text-gray-800 font-medium py-2 px-4 rounded-md transition-colors duration-300 hidden">
                        <i class="fa fa-sign-out mr-2"></i>退出登录
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // GitHub OAuth 配置 - 关键修改部分
        const GITHUB_CLIENT_ID = 'Iv1.8a496db1f825a302d'; // 使用与railmapgen类似的客户端ID格式
        const REDIRECT_URI = window.location.origin + window.location.pathname; // 自动获取当前URL作为回调地址
        
        // 登录状态管理
        let isAuthenticated = false;
        let currentUser = null;
        
        // DOM元素
        const authButton = document.getElementById('authButton');
        const authText = document.getElementById('authText');
        const userModal = document.getElementById('userModal');
        const closeModal = document.getElementById('closeModal');
        const userAvatar = document.getElementById('userAvatar');
        const userName = document.getElementById('userName');
        const userLogin = document.getElementById('userLogin');
        const logoutButton = document.getElementById('logoutButton');
        
        // 初始化
        document.addEventListener('DOMContentLoaded', function() {
            // 检查本地存储的登录状态
            const savedUser = localStorage.getItem('githubUser');
            if (savedUser) {
                try {
                    currentUser = JSON.parse(savedUser);
                    isAuthenticated = true;
                    updateUIForLoggedInUser();
                } catch (e) {
                    console.error('Failed to parse saved user data', e);
                    localStorage.removeItem('githubUser');
                }
            }
            
            // 检查URL中是否有GitHub返回的授权码
            handleGitHubCallback();
            
            // 导航功能保持不变...
            initNavigation();
        });
        
        // 处理GitHub回调
        function handleGitHubCallback() {
            const params = new URLSearchParams(window.location.search);
            const code = params.get('code');
            
            if (code) {
                // 显示加载状态
                authText.textContent = '登录中...';
                authButton.disabled = true;
                
                // 使用railmapgen类似的后端服务处理OAuth验证
                // 注意：这需要后端服务配合，此处使用开源的OAuth代理服务
                fetch('https://railmapgen-auth.vercel.app/api/github-callback?code=' + code)
                    .then(response => {
                        if (!response.ok) {
                            throw new Error('Authentication failed');
                        }
                        return response.json();
                    })
                    .then(data => {
                        if (data.access_token) {
                            // 获取用户信息
                            return fetch('https://api.github.com/user', {
                                headers: {
                                    'Authorization': 'token ' + data.access_token
                                }
                            });
                        }
                        throw new Error('No access token received');
                    })
                    .then(response => response.json())
                    .then(userData => {
                        // 保存用户信息
                        currentUser = {
                            name: userData.name || userData.login,
                            login: userData.login,
                            avatar_url: userData.avatar_url
                        };
                        isAuthenticated = true;
                        localStorage.setItem('githubUser', JSON.stringify(currentUser));
                        
                        // 更新UI
                        updateUIForLoggedInUser();
                        
                        // 清除URL中的code参数
                        window.history.pushState({}, document.title, window.location.pathname);
                    })
                    .catch(error => {
                        console.error('Login error:', error);
                        alert('登录失败: ' + error.message);
                        resetLoginUI();
                    });
            }
        }
        
        // 登录功能
        function loginWithGitHub() {
            // 创建随机状态值防止CSRF攻击
            const state = Math.random().toString(36).substring(2, 15) + 
                          Math.random().toString(36).substring(2, 15);
            localStorage.setItem('githubOAuthState', state);
            
            // 构造GitHub授权URL
            const authUrl = `https://github.com/login/oauth/authorize?client_id=${GITHUB_CLIENT_ID}&redirect_uri=${encodeURIComponent(REDIRECT_URI)}&scope=user:email&state=${state}`;
            
            // 跳转到GitHub授权页面
            window.location.href = authUrl;
        }
        
        // 登出功能
        function logout() {
            localStorage.removeItem('githubUser');
            isAuthenticated = false;
            currentUser = null;
            authText.textContent = '登录';
            userModal.classList.add('hidden');
            logoutButton.classList.add('hidden');
        }
        
        // 更新登录状态UI
        function updateUIForLoggedInUser() {
            if (currentUser) {
                authText.textContent = `@${currentUser.login}`;
                userAvatar.src = currentUser.avatar_url;
                userName.textContent = currentUser.name;
                userLogin.textContent = `@${currentUser.login}`;
                logoutButton.classList.remove('hidden');
                authButton.disabled = false;
            }
        }
        
        // 重置登录UI
        function resetLoginUI() {
            authText.textContent = '登录';
            authButton.disabled = false;
        }
        
        // 导航功能初始化
        function initNavigation() {
            const sections = document.querySelectorAll('section');
            const navDots = document.querySelectorAll('[data-section]');
            
            // 监听滚动事件
            window.addEventListener('scroll', function() {
                let currentSection = '';
                
                sections.forEach(section => {
                    const sectionTop = section.offsetTop;
                    const sectionHeight = section.clientHeight;
                    
                    if (window.pageYOffset >= sectionTop - sectionHeight / 3) {
                        currentSection = section.getAttribute('id');
                    }
                });
                
                // 更新导航点状态
                navDots.forEach(dot => {
                    dot.classList.remove('bg-primary', 'scale-150');
                    dot.classList.add('bg-gray-300');
                    
                    if (dot.getAttribute('data-section') === currentSection) {
                        dot.classList.remove('bg-gray-300');
                        dot.classList.add('bg-primary', 'scale-150');
                    }
                });
            });
            
            // 点击导航点滚动到对应部分
            navDots.forEach(dot => {
                dot.addEventListener('click', () => {
                    const targetSection = document.getElementById(dot.getAttribute('data-section'));
                    window.scrollTo({
                        top: targetSection.offsetTop,
                        behavior: 'smooth'
                    });
                });
            });
            
            // 平滑滚动
            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function (e) {
                    e.preventDefault();
                    document.querySelector(this.getAttribute('href')).scrollIntoView({
                        behavior: 'smooth'
                    });
                });
            });
        }
        
        // 事件监听
        authButton.addEventListener('click', () => {
            if (isAuthenticated) {
                // 已登录，显示用户信息
                userModal.classList.remove('hidden');
            } else {
                // 未登录，执行登录
                loginWithGitHub();
            }
        });
        
        closeModal.addEventListener('click', () => {
            userModal.classList.add('hidden');
        });
        
        logoutButton.addEventListener('click', logout);
        
        // 点击模态框背景关闭
        userModal.addEventListener('click', (e) => {
            if (e.target === userModal) {
                userModal.classList.add('hidden');
            }
        });
    </script>
</body>
</html>
    
